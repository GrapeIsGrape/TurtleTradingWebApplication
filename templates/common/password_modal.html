<!-- Password Modal -->
<div class="modal fade" id="passwordModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="passwordModalTitle">Enter Password</h5>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="passwordInput" class="form-label">Password</label>
                    <input type="password" class="form-control" id="passwordInput" placeholder="Enter password">
                </div>
                <div id="passwordError" class="alert alert-danger d-none" role="alert">
                    Incorrect password. Please try again.
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="passwordCancelBtn" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="submitPassword">Submit</button>
            </div>
        </div>
    </div>
</div>

<script>
    // Password validation handler
    function setupPasswordModal(options = {}) {
        const {
            correctPassword = 'admin',
            onSuccess = () => {},
            onCancel = () => {},
            modalTitle = 'Enter Password',
            canDismiss = true
        } = options;

        // Set modal title
        document.getElementById('passwordModalTitle').textContent = modalTitle;

        // Handle dismiss based on canDismiss option
        const modal = document.getElementById('passwordModal');
        if (!canDismiss) {
            modal.setAttribute('data-bs-backdrop', 'static');
            modal.setAttribute('data-bs-keyboard', 'false');
        }

        document.getElementById('submitPassword').addEventListener('click', function() {
            const password = document.getElementById('passwordInput').value;
            const errorDiv = document.getElementById('passwordError');
            
            if (password === correctPassword) {
                // Success
                errorDiv.classList.add('d-none');
                document.getElementById('passwordInput').value = '';
                bootstrap.Modal.getInstance(modal).hide();
                onSuccess();
            } else {
                // Show error message
                errorDiv.classList.remove('d-none');
                document.getElementById('passwordInput').value = '';
            }
        });

        document.getElementById('passwordCancelBtn').addEventListener('click', function() {
            document.getElementById('passwordInput').value = '';
            document.getElementById('passwordError').classList.add('d-none');
            onCancel();
        });

        // Allow Enter key to submit password
        document.getElementById('passwordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('submitPassword').click();
            }
        });
    }
</script>
